/**
 * @file BatteryMonitoring.c
 * @brief  Source code for Battery Monitoring Application
 * @author Joshua Lafleur (josh.lafleur@outlook.com)
 * @date 2023-12-27
 */

/******************************************************************************
 *                             I N C L U D E S
 ******************************************************************************/

/**< Module header */
#include "BatteryMonitoring.h"

/**< Driver Includes */
#include "HW_MAX14921.h"

/**< Other Includes */
#include "Module.h"

/******************************************************************************
 *                              D E F I N E S
 ******************************************************************************/

/******************************************************************************
 *                              E X T E R N S
 ******************************************************************************/

/******************************************************************************
 *                             T Y P E D E F S
 ******************************************************************************/

/******************************************************************************
 *                               M A C R O S
 ******************************************************************************/

/******************************************************************************
 *                           P U B L I C  V A R S
 ******************************************************************************/

/**
 * @brief  Stores public BMS struct
 */
BMS_S BMS;

/******************************************************************************
 *                         P R I V A T E  V A R S
 ******************************************************************************/

/******************************************************************************
 *            P U B L I C  F U N C T I O N  P R O T O T Y P E S
 ******************************************************************************/

/******************************************************************************
 *          P R I V A T E  F U N C T I O N  P R O T O T Y P E S
 ******************************************************************************/

/******************************************************************************
 *                       P U B L I C  F U N C T I O N S
 ******************************************************************************/

/**
 * @brief  BMS Module init function
 */
static void BMS_Init()
{
    BMS.state = BMS_INIT;

    if (!MAX_Init())
    {
        BMS.state = BMS_ERROR;
    }
    else {
        BMS.state = BMS_WAITING;
    }
}

/**
 * @brief  10kHz BMS periodic function. Used for voltage sampling
 */
static void BMS10kHz_PRD()
{
}

/**
 * @brief  10 Hz BMS periodic function
 */
static void BMS10Hz_PRD()
{
}

/**
 * @brief  1Hz BMS periodic function
 */
static void BMS1Hz_PRD()
{
}

/**
 * @brief  BMS Module descriptor
 */
const ModuleDesc_S BMS_desc = {
    .moduleInit        = &BMS_Init,
    .periodic10kHz_CLK = &BMS10kHz_PRD,
    .periodic10Hz_CLK  = &BMS10Hz_PRD,
    .periodic1Hz_CLK   = &BMS1Hz_PRD,
};

/******************************************************************************
 *                     P R I V A T E  F U N C T I O N S
 ******************************************************************************/
